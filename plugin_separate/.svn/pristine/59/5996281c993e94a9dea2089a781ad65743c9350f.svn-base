package com.hajduczek.xmleditor.mouse;

import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.util.List;

import javax.swing.JMenuItem;
import javax.swing.JPopupMenu;
import javax.swing.JTable;

import com.hajduczek.xmleditor.Attribute;
import com.hajduczek.xmleditor.AttributesModel;

public class AttributeTablePopUpMenu extends JPopupMenu {
    private static final long serialVersionUID = -6524284223481340575L;
	private JMenuItem addItem;
	private JMenuItem deleteItem;
	    
	public AttributeTablePopUpMenu(boolean deleteOptionEnable, final JTable jTable, final int selectedRow){
		this.addItem = new JMenuItem("Add new attribute");
        this.addItem.addActionListener(new ActionListener() {
			
			@Override
			public void actionPerformed(ActionEvent e) {
				if (jTable.getModel() instanceof AttributesModel) {
					AttributesModel attributeModel = (AttributesModel)jTable.getModel();
					List<Attribute> attributes = attributeModel.getAttributes();
					attributes.add(new Attribute("enter_name", "enter_value"));
					jTable.repaint();
					jTable.getParent().repaint();
					jTable.repaint();
				}
			}
		});
		this.add(addItem);
        
        this.deleteItem = new JMenuItem("Delete attribute");
        this.deleteItem.addActionListener(new ActionListener() {

			@Override
			public void actionPerformed(ActionEvent e) {
				System.out.println("WYBRAŁEM USUŃ");
				if (jTable.getModel() instanceof AttributesModel) {
					AttributesModel attributeModel = (AttributesModel)jTable.getModel();
					List<Attribute> attributes = attributeModel.getAttributes();
					Object obj = attributeModel.getValueAt(selectedRow, 0);
					Attribute attrToDel = null;
					if (obj != null && attributes != null) {
						for (Attribute attr : attributes) {
							if (attr.getName().equals((String)obj)) {
								attrToDel = attr;
								break;
							}
						}
						if (attrToDel != null) {
							attributes.remove(attrToDel);
						}
						jTable.repaint();
					}
				}
			}
        });
        this.deleteItem.setEnabled(deleteOptionEnable);
        this.add(deleteItem);
    }
}