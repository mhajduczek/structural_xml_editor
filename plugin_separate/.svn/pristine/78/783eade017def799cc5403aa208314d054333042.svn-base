package plugin_hello_world;

import java.awt.BorderLayout;
import java.awt.Frame;

import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTabbedPane;
import javax.swing.JTable;
import javax.swing.table.TableColumn;

import org.eclipse.jface.util.IPropertyChangeListener;
import org.eclipse.jface.util.PropertyChangeEvent;
import org.eclipse.swt.SWT;
import org.eclipse.swt.awt.SWT_AWT;
import org.eclipse.swt.widgets.Composite;
import org.eclipse.ui.part.ViewPart;


/**
 * @author Prakash G.R.
 *
 */
public class ComponentPropertiesView extends ViewPart implements IPropertyChangeListener {
	
	Composite plate = null; //moze nie bedzie potrzebne!
	Frame frame = null;
	JPanel panel = null;
	JTabbedPane tabbedPane = null;
	@Override
	public void propertyChange(PropertyChangeEvent event) {
		System.out.println("ktos mnie zawolal: " + event);
		tabbedPane.removeAll();
		
		if (event.getNewValue() instanceof XmlDocument) {
			tabbedPane.addTab("General", null, new JPanel(), "podpowiedz");
			//JPanel attrPanel = new JPanel();
			AttributesModel attributesModel = new AttributesModel((XmlDocument)event.getNewValue());

			JTable attributesTable = new JTable(attributesModel);
			TableColumn columnName = attributesTable.getColumn("Name");
			columnName.setWidth(140);
			TableColumn columnValue = attributesTable.getColumn("Value");
			columnValue.setWidth(140);
			JPanel attrPanel = new JPanel(new BorderLayout());
			attrPanel.add(attributesTable.getTableHeader(), BorderLayout.PAGE_START);
			attrPanel.add(new JScrollPane(attributesTable), BorderLayout.CENTER);
			//JTable table = new JTable();
			//attrPanel.add(table);
			
			tabbedPane.addTab("Attributes", null, attrPanel, "podpowiedz");
		} else if (event.getNewValue() instanceof XmlTag) {
			tabbedPane.addTab("General", null, new JPanel(), "podpowiedz");
			tabbedPane.addTab("Attributes", null, new JPanel(), "podpowiedz");
			tabbedPane.addTab("Text", null, new JPanel(), "podpowiedz");
		}
	}

	@Override
	public void createPartControl(Composite parent) {
		ListenerStore.addListener(this);
		plate = new Composite(parent, SWT.EMBEDDED | SWT.NO_BACKGROUND);
		frame = SWT_AWT.new_Frame(plate);
		frame.setLayout(new java.awt.GridLayout(1,1));
		panel = new JPanel();
		
		tabbedPane = new JTabbedPane();
	    tabbedPane.setTabPlacement(JTabbedPane.LEFT);

	    frame.add(tabbedPane);
	}

	@Override
	public void setFocus() {
		System.out.println("ktos zwrocil na mnie uwage!");
	}
}
